/*
 4screens-engageform v0.1.6
 (c) 2014 Nopattern sp. z o.o.
 License: proprietary
*/
"use strict";angular.module("4screens.engageform",["4screens.common","4screens.settings","LocalStorageModule","youtube-embed","djds4rce.angular-socialshare","ngMessages"]).config(["localStorageServiceProvider",function(e){e.prefix="4screens.engageform"}]),angular.module("4screens.engageform").run(["$templateCache",function(e){e.put("views/engageform/branding-logo.html",'<span>{{ branding.text }}</span> <a title="4Screens" ng-if="defaultBranding" ng-href="{{ branding.link }}" target="_blank" ng-class="{ \'logo-dark-32\': themeName === \'theme-dark\' || ( themeName === \'theme-light\' && isHigherThanViewport ) || ( themeName === \'theme-light\' && smallViewport ) || show404, \'logo-light-32\': themeName === \'theme-light\' && !isHigherThanViewport && !smallViewport }">4Screens</a> <a ng-if="!defaultBranding" class="four-screens__footer-logo--link" ng-href="{{ branding.link }}" target="_blank"><img ng-src="{{ branding.imageUrl }}"></a>')}]),angular.module("4screens.engageform").run(["$templateCache",function(e){e.put("views/engageform/main.html",'<link rel="stylesheet" type="text/css" data-ng-href="{{ customThemeCssFile || staticThemeCssFile }}" data-ng-if="!!customThemeCssFile || !!staticThemeCssFile"><div id="four-screens-application" class="{{themeName}} {{screenType}}" ng-class="{embedded: isEmbedded, mobile: isMobile, \'fluid-height\': isFluid}"><div class="theme-background-image-file-wrapper theme-background-brightness theme-background-color"><picture data-ng-if="quiz.theme.backgroundImageFile" class="position-{{quiz.theme.backgroundImagePosition}}"><source media="(min-width: 1021px)" data-ng-srcset="{{ getBgImgUrl( quiz.theme.backgroundImageFile, 1920, \'1.0\', quiz.theme.backgroundImageBlur ) }}, {{ getBgImgUrl( quiz.theme.backgroundImageFile, 1920, \'1.5\', quiz.theme.backgroundImageBlur ) }} 1.5x, {{ getBgImgUrl( quiz.theme.backgroundImageFile, 1920, \'2.0\', quiz.theme.backgroundImageBlur ) }} 2.0x"><source media="(min-width: 769px)" data-ng-srcset="{{ getBgImgUrl( quiz.theme.backgroundImageFile, 1020, \'1.0\', quiz.theme.backgroundImageBlur ) }}, {{ getBgImgUrl( quiz.theme.backgroundImageFile, 1020, \'1.5\', quiz.theme.backgroundImageBlur ) }} 1.5x, {{ getBgImgUrl( quiz.theme.backgroundImageFile, 1020, \'2.0\', quiz.theme.backgroundImageBlur ) }} 2.0x"><source media="(min-width: 481px)" data-ng-srcset="{{ getBgImgUrl( quiz.theme.backgroundImageFile, 768, \'1.0\', quiz.theme.backgroundImageBlur ) }}, {{ getBgImgUrl( quiz.theme.backgroundImageFile, 768, \'1.5\', quiz.theme.backgroundImageBlur ) }} 1.5x, {{ getBgImgUrl( quiz.theme.backgroundImageFile, 768, \'2.0\', quiz.theme.backgroundImageBlur ) }} 2.0x"><source media="(min-width: 0px)" data-ng-srcset="{{ getBgImgUrl( quiz.theme.backgroundImageFile, 480, \'1.0\', quiz.theme.backgroundImageBlur ) }}, {{ getBgImgUrl( quiz.theme.backgroundImageFile, 480, \'1.5\', quiz.theme.backgroundImageBlur ) }} 1.5x, {{ getBgImgUrl( quiz.theme.backgroundImageFile, 480, \'2.0\', quiz.theme.backgroundImageBlur ) }} 2.0x"><img data-ng-src="{{ getBgImgUrl( quiz.theme.backgroundImageFile, 1920, \'1.0\', quiz.theme.backgroundImageBlur ) }}" data-ng-srcset="{{ getBgImgUrl( quiz.theme.backgroundImageFile, 1920, \'1.0\', quiz.theme.backgroundImageBlur ) }}, {{ getBgImgUrl( quiz.theme.backgroundImageFile, 1920, \'1.5\', quiz.theme.backgroundImageBlur ) }} 1.5x, {{ getBgImgUrl( quiz.theme.backgroundImageFile, 1920, \'2.0\', quiz.theme.backgroundImageBlur ) }} 2.0x"></picture></div><div class="four-screens__embed-container theme-main-font" data-ng-class="wayAnimateClass"><div data-ng-repeat="question in questions" class="questionnaire animate-if" data-ng-if="$index == currentQuestion.index()"><div class="question-content-wrapper question-content-wrapper--{{question.type}}" observe-height><div class="four-screens__content wrapper" data-ng-class="{ \'content__type--forms\': question.type == \'forms\', \'content__type--multi-choice\': question.type == \'multiChoice\', \'content__type--picture-choice\': question.type == \'pictureChoice\', \'content__type--rate-it\': question.type == \'rateIt\', \'content__type--start-page\': question.type == \'startPage\', \'content__type--end-page\': question.type == \'endPage\', \'content__type--summary-page\': question.type == \'summaryPage\' }" data-ng-include="\'views/engageform/question-\' + question.type + \'.html\'"></div></div></div></div><div class="four-screens__embed-container theme-main-font page404" data-ng-if="show404"><div class="questionnaire animate-if"><div class="question-content-wrapper question-content-wrapper--404"><div class="four-screens__content wrapper"><h2 class="theme-question-color text-center">Engageform not found</h2><div class="main-content-description theme-question-color text-center"><p>We\'re sorry, we can\'t find the engageform you\'re looking for.</p></div></div></div></div></div><div class="message-box message-box__require theme-button-color theme-question-color" data-ng-class="{\'is-active\': !!requiredMessage }">{{requiredMessage}}</div><div class="four-screens__footer" data-ng-show="questions[currentQuestion.index()].type !== \'startPage\' && questions[currentQuestion.index()].type !== \'endPage\'"><div class="progress"><span class="progress__bar"><span class="progress__bar--line theme-button-color" data-ng-class="{\'progress__bar--full-size\': progressBarWidth() === 100 }" data-ng-style="{\'width\': progressBarWidth()+\'%\'}"></span></span></div><branding class="four-screens__footer-logo" theme-name="themeName" is-higher-than-viewport="isHigherThanViewport" small-viewport="smallViewport"></branding><button class="progress__btn progress__btn--prev fa-stack fa-lg" data-ng-show="hasPrev()" data-ng-click="prev()"><i class="fa fa-circle fa-stack-2x theme-navigation-btn-color"></i> <i class="fa fa-angle-left"></i></button> <button class="progress__btn progress__btn--next fa-stack fa-lg" data-ng-show="pagination.curr() < pagination.last" data-ng-click="next($event)"><i class="fa fa-circle fa-stack-2x theme-navigation-btn-color"></i> <i class="fa fa-angle-right"></i></button> <button class="progress__btn progress__btn--submit theme-button-color theme-question-color" data-ng-show="showSubmitButton()" data-ng-click="submitQuiz($event)"><span>submit</span></button></div></div>')}]),angular.module("4screens.engageform").run(["$templateCache",function(e){e.put("views/engageform/question-endPage.html",'<div class="scored theme-question-color" data-ng-if="quiz.type === \'score\'">{{ question.coverPage.scoreLabel || \'You scored\' }} <span class="scored-text"><span class="scored-text-fill" data-ng-style="{height: ( 100 - scoredPoints ) + \'%\'}">{{scoredPoints || 0}}</span>{{ (scoredPoints || 0) + \'%\'}}</span></div><h2 class="theme-question-color text-center" data-ng-bind-html="question.text | nl2br" data-ng-if="!!question.text"></h2><div class="main-content-description theme-question-color text-center" data-ng-if="!!question.description"><p data-ng-bind-html="question.description | nl2br"></p></div><picture class="main-media-image" data-ng-if="!!currentQuestion.mainMedia() && !!mainMediaImg()" data-ng-class="{\'no-transform\': !question.imageData, \'transform\': question.imageData}" data-ng-style="{\'padding-bottom\': mainMediaImg().paddingBottom + \'%\'}"><img data-ng-style="{ \'width\': mainMediaImg().width + \'%\', \'left\' : (question.imageData.left > 0 ? question.imageData.left : 0) + \'%\', \'top\' : (question.imageData.top > 0 ? question.imageData.top : 0) + \'%\' }" data-ng-src="{{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'1.0\' ) }}" data-ng-srcset="{{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'1.0\' ) }}, {{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'1.5\' ) }} 1.5x, {{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'2.0\' ) }} 2.0x"></picture><div class="text-center main-footer" data-ng-if="question.coverPage.exitLink && question.coverPage.link"><a class="btn btn--round-corner btn--normal theme-button-color theme-question-color" rel="nofollow" target="_blank" title="{{question.coverPage.buttonText}}" data-ng-href="{{(question.coverPage.link.indexOf(\'http\') === -1 ? \'http://\' : \'\') + question.coverPage.link}}">{{question.coverPage.buttonText || "Thank You"}}</a></div><div data-ng-if="question.coverPage.showSocialShares && socialShare().enabled" data-ng-include="\'views/engageform/social-share.html\'"></div>')}]),angular.module("4screens.engageform").run(["$templateCache",function(e){e.put("views/engageform/question-forms.html",'<h2 class="theme-question-color text-left" data-ng-bind-html="question.text | nl2br" data-ng-if="!!question.text"></h2><div class="main-content-description theme-question-color text-left" data-ng-if="!!question.description"><p data-ng-bind-html="question.description | nl2br"></p></div><picture class="main-media-image" data-ng-if="!!currentQuestion.mainMedia() && !!mainMediaImg()" data-ng-class="{\'no-transform\': !question.imageData, \'transform\': question.imageData}" data-ng-style="{\'padding-bottom\': mainMediaImg().paddingBottom + \'%\'}"><img data-ng-style="{ \'width\': mainMediaImg().width + \'%\', \'left\' : (question.imageData.left > 0 ? question.imageData.left : 0) + \'%\', \'top\' : (question.imageData.top > 0 ? question.imageData.top : 0) + \'%\' }" data-ng-src="{{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'1.0\' ) }}" data-ng-srcset="{{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'1.0\' ) }}, {{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'1.5\' ) }} 1.5x, {{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'2.0\' ) }} 2.0x"></picture><form action name="form" class="form" formnovalidate><fieldset><div class="form__field" data-ng-repeat="input in question.forms.inputs"><label for="{{input._id}}" data-ng-bind="input.label"></label> <input type="email" validate-full-email placeholder="{{input.label}}" name="{{input._id}}" data-ng-if="input.type==\'email\'" data-ng-model="questionAnswer.status[input._id]" formnovalidate ng-required="currentQuestion.requiredAnswer()"> <input type="text" placeholder="{{input.label}}" name="{{input._id}}" data-ng-if="input.type==\'text\'" data-ng-model="questionAnswer.status[input._id]" formnovalidate ng-required="currentQuestion.requiredAnswer()"> <input type="tel" placeholder="{{input.label}}" name="{{input._id}}" data-ng-if="input.type==\'phone\'" data-ng-model="questionAnswer.status[input._id]" formnovalidate ng-required="currentQuestion.requiredAnswer()"> <input type="url" placeholder="{{input.label}}" name="{{input._id}}" data-ng-if="input.type==\'url\'" data-ng-model="questionAnswer.status[input._id]" formnovalidate ng-required="currentQuestion.requiredAnswer()"> <textarea name="{{input._id}}" id cols="30" rows="10" data-ng-if="input.type==\'textarea\'" placeholder="{{input.label}}" data-ng-model="questionAnswer.status[input._id]" formnovalidate ng-required="currentQuestion.requiredAnswer()"></textarea> <span data-ng-if="question.settings.showAnswers && questionAnswer.selected && summaryMode" class="form__field--filled" ng-class="{\'textarea\': input.type==\'textarea\' }"><span>Filled {{ questionAnswer.count }} time{{ questionAnswer.count === 1 ? \'\' : \'s\' }}</span> <span><div data-ng-messages="form[input._id].$error" class="message text-right" data-ng-class="{\'is-active\': !!form[input._id].$error.fullEmail || !!form[input._id].$error.url}"><div data-ng-message="fullEmail">Your field has an invalid email address</div><div data-ng-message="email">Your field has an invalid email address</div><div data-ng-message="number">Only numbers</div><div data-ng-message="url">Your field has a invalid url address</div></div></span></span></div><input type="text" class="hidden" name="form" data-ng-model="questionAnswer.form" data-ng-init="questionAnswer.form=form"></fieldset><div class="hint"><i class="fa fa-info-circle"></i>&nbsp;<span>Type your answer above. Press next to continue.</span></div></form>')}]),angular.module("4screens.engageform").run(["$templateCache",function(e){e.put("views/engageform/question-multiChoice.html",'<h2 class="theme-question-color text-left" data-ng-bind-html="question.text | nl2br" data-ng-if="!!question.text"></h2><div class="main-content-description theme-question-color text-left" data-ng-if="!!question.description"><p data-ng-bind-html="question.description | nl2br"></p></div><div class="header__wrapper" data-ng-if="!!currentQuestion.mainMedia() && !!mainMediaImg()"><picture class="main-media-image" data-ng-class="{\'no-transform\': !question.imageData, \'transform\': question.imageData}" data-ng-style="{\'padding-bottom\': mainMediaImg().paddingBottom + \'%\'}"><img data-ng-style="{ \'width\': mainMediaImg().width + \'%\', \'left\' : (question.imageData.left > 0 ? question.imageData.left : 0) + \'%\', \'top\' : (question.imageData.top > 0 ? question.imageData.top : 0) + \'%\' }" data-ng-src="{{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'1.0\' ) }}" data-ng-srcset="{{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'1.0\' ) }}, {{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'1.5\' ) }} 1.5x, {{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'2.0\' ) }} 2.0x"></picture></div><div data-ng-click="sendAnswer( answer._id )" data-ng-repeat="answer in question.answers" class="questionnaire__answer" data-ng-class="{\'theme-button-color questionnaire__answer--selected\': questionAnswer.selected === answer._id, \'theme-answer-background-color theme-answer-border-color\': questionAnswer.selected !== answer._id, \'questionnaire__answer--notcorrect\': !!questionAnswer.selected && questionAnswer.selected !== answer._id }"><div class="answer__bar theme-answer-select-background-result-color" ng-style="{\'width\': formatAnswers(questionAnswer.stats[answer._id])+\'%\'}" data-ng-if="question.settings.showAnswers && question.settings.showAnswers !== false"></div><label data-ng-class="{ \'theme-question-color\': questionAnswer.selected === answer._id, \'theme-answer-color\': questionAnswer.selected !== answer._id }">{{answer.text}} <span class="theme-question-result-color-text ng-animate"><span data-ng-if="question.settings.showAnswers && questionAnswer.selected">{{ formatAnswers(questionAnswer.stats[answer._id]) | number:1 }} %</span> <i class="fa" data-ng-if="question.settings.showCorrectAnswer && questionAnswer.selected === answer._id" data-ng-class="{\'fa-check\': questionAnswer.correct === answer._id, \'fa-times\': questionAnswer.correct !== answer._id }"></i> <span></span></span></label></div>')}]),angular.module("4screens.engageform").run(["$templateCache",function(e){e.put("views/engageform/question-pictureChoice.html",'<h2 class="theme-question-color text-left" data-ng-bind-html="question.text | nl2br" data-ng-if="!!question.text"></h2><div class="main-content-description theme-question-color text-left" data-ng-if="!!question.description"><p data-ng-bind-html="question.description | nl2br"></p></div><div class="header__wrapper" data-ng-if="!!currentQuestion.mainMedia() && !!mainMediaImg()"><picture class="main-media-image" data-ng-class="{\'no-transform\': !question.imageData, \'transform\': question.imageData}" data-ng-style="{\'padding-bottom\': mainMediaImg().paddingBottom + \'%\'}"><img data-ng-style="{ \'width\': mainMediaImg().width + \'%\', \'left\' : (question.imageData.left > 0 ? question.imageData.left : 0) + \'%\', \'top\' : (question.imageData.top > 0 ? question.imageData.top : 0) + \'%\' }" data-ng-src="{{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'1.0\' ) }}" data-ng-srcset="{{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'1.0\' ) }}, {{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'1.5\' ) }} 1.5x, {{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'2.0\' ) }} 2.0x"></picture></div><div class="list"><div data-ng-repeat="answer in question.answers" class="questionnaire__answer questionnaire__answer--picture-choice" data-ng-class="{\'questionnaire__answer--selected\': questionAnswer.selected === answer._id, \'questionnaire__answer--notcorrect\': !!questionAnswer.selected && questionAnswer.selected !== answer._id }" data-ng-click="sendAnswer( answer._id )"><figure data-ng-class="{ \'theme-answer-select-background-result-color\': questionAnswer.selected === answer._id, \'theme-answer-background-color theme-answer-border-color\': questionAnswer.selected !== answer._id, \'questionnaire__answer--notcorrect\': !!questionAnswer.selected && questionAnswer.selected !== answer._id }"><div class="image-wrapper"><picture class="thumb-media-image"><img ng-if="answer.imageFile" data-ng-style="{ \'width\': answer.imageData.width + \'%\', \'left\': answer.imageData.left + \'%\', \'top\': answer.imageData.top + \'%\' }" data-ng-src="{{ getImgUrl( currentQuestion.answerMedia( answer.imageFile ), 300, \'1.0\' ) }}" data-ng-srcset="{{ getImgUrl( currentQuestion.answerMedia( answer.imageFile ), 300, \'1.0\' ) }}, {{ getImgUrl( currentQuestion.answerMedia( answer.imageFile ), 300, \'1.5\' ) }} 1.5x, {{ getImgUrl( currentQuestion.answerMedia( answer.imageFile ), 300, \'2.0\' ) }} 2.0x"></picture><div class="answer__bar" data-ng-if="question.settings.showAnswers && question.settings.showAnswers !== false && !!questionAnswer.stats"></div></div><figcaption class="theme-answer-color">{{ answer.text }}</figcaption><div class="results"><span class="results__precent" data-ng-if="question.settings.showAnswers && question.settings.showAnswers !== false && questionAnswer.selected">{{ !!questionAnswer.stats[answer._id] ? (100 * questionAnswer.stats[answer._id]) : 0 | number:1 }}<span class="precent">%</span></span> <span class="results__triangle" data-ng-if="question.settings.showCorrectAnswer && question.settings.showCorrectAnswer !== false && questionAnswer.selected === answer._id" data-ng-class="{\'is-correct\': !!question.settings.showCorrectAnswer && !!questionAnswer.status[ answer._id ].correct, \'is-incorrect\': !questionAnswer.status[ answer._id ].correct }"><i class="fa" data-ng-class="{\'fa-check\': questionAnswer.status[ answer._id ].correct, \'fa-times\': !questionAnswer.status[ answer._id ].correct }"></i></span></div></figure></div></div>')}]),angular.module("4screens.engageform").run(["$templateCache",function(e){e.put("views/engageform/question-rateIt.html",'<h2 class="theme-question-color text-left" data-ng-bind-html="question.text | nl2br" data-ng-if="!!question.text"></h2><div class="main-content-description theme-question-color text-left" data-ng-if="!!question.description"><p data-ng-bind-html="question.description | nl2br"></p></div><picture class="main-media-image" data-ng-if="!!currentQuestion.mainMedia() && !!mainMediaImg()" data-ng-class="{\'no-transform\': !question.imageData, \'transform\': question.imageData}" data-ng-style="{\'padding-bottom\': mainMediaImg().paddingBottom + \'%\'}"><img data-ng-style="{ \'width\': mainMediaImg().width + \'%\', \'left\' : (question.imageData.left > 0 ? question.imageData.left : 0) + \'%\', \'top\' : (question.imageData.top > 0 ? question.imageData.top : 0) + \'%\' }" data-ng-src="{{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'1.0\' ) }}" data-ng-srcset="{{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'1.0\' ) }}, {{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'1.5\' ) }} 1.5x, {{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'2.0\' ) }} 2.0x"></picture><div class="list list__rating list__rating--{{question.rateIt.rateType || \'star\'}}" data-ng-init="AA = makeTimes(question.rateIt.maxRateItValue || 5)"><span data-ng-click="sendAnswer(AA.length - $index, $event)" class="theme-question-color" data-ng-class="{\'item__selected\': questionAnswer.selected >= AA.length - $index}" data-ng-repeat="r in AA" data-ng-if="question.rateIt.rateType !== \'number\'"><i class="fa"></i> <span class="number">{{AA.length - $index}}</span></span> <span data-ng-click="sendAnswer(AA.length - $index, $event)" class="theme-question-color" data-ng-class="{\'item__selected\': questionAnswer.selected == AA.length - $index}" data-ng-repeat="r in AA" data-ng-if="question.rateIt.rateType === \'number\'"><i class="fa"></i> <span class="number">{{AA.length - $index}}</span></span></div><div class="footer-rating"><div class="cell"><div class="rating__label theme-question-color text-left"><span>{{question.rateIt.minLabel}}</span></div></div><div class="cell"><div class="rating__results theme-question-color"><span data-ng-if="questionAnswer.average">Average: {{ questionAnswer.average | number:1 }}</span></div></div><div class="cell"><div class="rating__label theme-question-color text-right"><span>{{question.rateIt.maxLabel}}</span></div></div></div>')}]),angular.module("4screens.engageform").run(["$templateCache",function(e){e.put("views/engageform/question-startPage.html",'<h2 class="theme-question-color text-center" data-ng-bind-html="question.text | nl2br" data-ng-if="!!question.text"></h2><div class="main-content-description theme-question-color text-center" data-ng-if="!!question.description"><p data-ng-bind-html="question.description | nl2br"></p></div><picture class="main-media-image" data-ng-if="!!currentQuestion.mainMedia() && !!mainMediaImg()" data-ng-class="{\'no-transform\': !question.imageData, \'transform\': question.imageData}" data-ng-style="{\'padding-bottom\': mainMediaImg().paddingBottom + \'%\'}"><img data-ng-style="{ \'width\': mainMediaImg().width + \'%\', \'left\' : (question.imageData.left > 0 ? question.imageData.left : 0) + \'%\', \'top\' : (question.imageData.top > 0 ? question.imageData.top : 0) + \'%\' }" data-ng-src="{{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'1.0\' ) }}" data-ng-srcset="{{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'1.0\' ) }}, {{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'1.5\' ) }} 1.5x, {{ getMainImgUrl( currentQuestion.mainMedia().src, 680, \'2.0\' ) }} 2.0x"></picture><div class="quiz-icon quiz-icon-big" data-ng-if="!currentQuestion.mainMedia() && currentQuestion.settings(\'showMainMedia\')"><i class="fa theme-question-color" data-ng-class="{ \'fa-bar-chart\': quiz.type === \'poll\', \'fa-edit\': quiz.type === \'survey\', \'fa-trophy\': quiz.type === \'score\', \'fa-group\': quiz.type === \'outcome\' }"></i></div><div class="text-center main-footer"><button class="btn btn--round-corner btn--normal theme-button-color theme-question-color" data-ng-show="hasNext()" data-ng-click="next($event)">{{question.coverPage.buttonText || "Let\'s get started"}}</button> <button class="btn btn--round-corner btn--normal theme-button-color theme-question-color" data-ng-show="!hasNext()">{{question.coverPage.buttonText || "Let\'s get started"}}</button></div>')}]),angular.module("4screens.engageform").run(["$templateCache",function(e){e.put("views/engageform/question-summaryPage.html",'<h2 class="theme-question-color text-center" data-ng-bind-html="question.text | nl2br" data-ng-if="!!question.text"></h2><div data-ng-repeat="answer in question.stats" class="questionnaire__answer theme-answer-background-color theme-answer-border-color questionnaire__answer--notcorrect"><div class="answer__bar theme-answer-select-background-result-color" ng-style="{\'width\': formatAnswers(answer.percent)+\'%\'}"></div><label class="theme-answer-color">{{ answer.title ? answer.title + \' (\' + answer.group + \')\' : answer.group }} <span class="theme-question-result-color-text ng-animate"><span>{{ formatAnswers(answer.percent) | number:1 }} %</span> <i class="fa" data-ng-if="question.settings.showCorrectAnswer && questionAnswer.selected === answer._id" data-ng-class="{\'fa-check\': questionAnswer.correct === answer._id, \'fa-times\': questionAnswer.correct !== answer._id }"></i> <span></span></span></label></div>')}]),angular.module("4screens.engageform").run(["$templateCache",function(e){e.put("views/engageform/social-share.html",'<section class="social-shares--icons"><a class="social-shares--icons__fb" data-ng-click="socialShare().facebook.share()"><i class="fa fa-facebook"></i></a><a class="social-shares--icons__twitter" href="https://twitter.com/intent/tweet?text={{ socialShare().link + \' \' + socialShare().title + \' \' + socialShare().description }}"><i class="fa fa-twitter"></i></a></section>')}]),angular.module("4screens.engageform").controller("engageformDefaultCtrl",["CONFIG","EngageformBackendService","CloudinaryService","$scope","$routeParams","$timeout","$window","$document","$http","$q","previewMode","summaryMode","message","isMobile","isEmbedded","openInFullscreen","$rootScope",function(e,t,n,a,i,s,r,o,u,c,d,l,g,m,p,f,h){function q(e){var t=w(e);a.themeName=.299*t.red+.587*t.green+.114*t.blue>186?"theme-light":"theme-dark"}function w(e){var t,n,a;if("#"===e[0]?e=e.substr(1):(t=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),e=t&&4===t.length?("0"+parseInt(t[1],10).toString(16)).slice(-2)+("0"+parseInt(t[2],10).toString(16)).slice(-2)+("0"+parseInt(t[3],10).toString(16)).slice(-2):""),3===e.length){n=e,e="",n=/^([a-f0-9])([a-f0-9])([a-f0-9])$/i.exec(n).slice(1);for(var i=0;3>i;i++)e+=n[i]+n[i]}return a=/^([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i.exec(e).slice(1),{red:parseInt(a[0],16),green:parseInt(a[1],16),blue:parseInt(a[2],16)}}function b(){a.screenType=r.innerHeight>r.innerWidth?"narrow":"wide"}function v(){a.$$phase||a.$apply(b)}function x(e){var n;e.data.length&&(e.origin.indexOf("facebook")>-1||e.origin.indexOf("twitter")>-1||(n=JSON.parse(e.data),d&&"results"===n.name?a.$apply(function(){t.preview.setUserResults(n.results).then(function(){a.sentAnswer()})}):l&&"summary"===n.name&&a.$apply(function(){t.preview.setAnswersResults(n).then(function(e){k||U.promise.then(function(){var n;if("outcome"===a.quiz.type)n="Outcomes";else{if("score"!==a.quiz.type)return a.sentAnswer();n="Scores"}k={type:"summaryPage",text:n,quizId:i.engageFormId,stats:e},a.questions.push(k),a.normalQuestions.push(k),a.normalQuestionsAmmount=a.normalQuestions.length,a.pagination.last=a.normalQuestionsAmmount,t.questions.sync(a.questions,a.currentQuestion.index()),a.sentAnswer()})})})))}function y(e,t,n){var a=Math.min(t/e.maxWidth,1),i=Math.min(n/e.maxHeight,1),s=Math.max(e.minFontSize,Math.min(a,i));angular.element(r.document.querySelector("html")).css("font-size",Math.floor(1e3*s)/10+"%")}function A(e){return a.getUser().uid?t.quiz.submit(e).then(function(e){a.pickCorrectEndPage(e),_.where(a.questions,{type:"endPage"}).length?a.next(null,!0):a.requiredMessage="Thank you!"}).catch(function(e){a.requiredMessage=e.data.msg||"Unexpected error"}):(a.requiredMessage="You need to answer at least one question to finish quiz",!1)}function I(e,t){var n=[];for(var i in e)e.hasOwnProperty(i)&&n.push({_id:i,value:e[i]});if(n.length)return a.sendAnswer(n,t,!0);if(a.pagination.curr()>=a.pagination.last){var s=c.defer();return s.resolve(),s.promise}a.next(null,!0)}var M,k,z,P=i.engageFormId,Q=angular.element(o.find("body").eq(0)),U=c.defer();g.on("height-type",function(e){a.isFluid=e.fluidHeight}),a.smallViewport=r.innerWidth<=1024,a.isEmbedded=p,a.isMobile=m,a.$on("height-changed",function(e,t){t.isHigherThanViewport?Q.addClass("higher-than-window"):Q.removeClass("higher-than-window"),a.isHigherThanViewport=t.isHigherThanViewport,g.send("height-changed",angular.extend(t,{page:a.currentQuestion.index()}))}),angular.element(r).bind("resize",_.throttle(function(){a.smallViewport=r.innerWidth<=1024},200)),a.pagination={curr:function(){},last:0},a.summaryMode=l,t.quiz.get(P).then(function(e){a.quiz=e,h.$broadcast("quizReady",e),q(e.theme.backgroundColor),a.staticThemeCssFile=t.quiz.getStaticThemeCssFile(),t.questions.get().then(function(e){a.wayAnimateClass="way-animation__next",a.questions=_.sortBy(e,"position"),l&&(_.remove(a.questions,function(e){return"startPage"===e.type||"endPage"===e.type}),_.map(a.questions,function(e){return e.settings&&(e.settings.showAnswers=!0),e.requiredAnswer&&(e.requiredAnswer=!1),e})),a.endPages=_.groupBy(a.questions,{type:"endPage"}).true||[],a.startPages=_.groupBy(a.questions,{type:"startPage"}).true||[],a.normalQuestions=_.groupBy(a.questions,function(e){return"endPage"!==e.type&&"startPage"!==e.type}).true||[],a.hasForms=_.some(a.normalQuestions,{type:"forms"}),a.questions=a.startPages.length?new Array(a.startPages[0]):[],a.questions=a.questions.concat(a.normalQuestions),a.normalQuestions.length<1&&("poll"!==a.quiz.type&&"survey"!==a.quiz.type||1!==a.endPages.length||a.questions.push(a.endPages[0])),a.normalQuestionsAmmount=a.normalQuestions.length,a.pagination={curr:function(){return a.currentQuestion.index()+(a.startPages.length?0:1)},last:a.normalQuestions.length},t.questions.sync(a.questions,a.currentQuestion.index()),a.sentAnswer(),a.socialShare().init(),U.resolve(),z=!!_.find(a.endPages,{coverPage:{showSocialShares:!0}}),h.siteTitle=a.quiz.settings.share.title||"",h.siteDescription=a.quiz.settings.share.description||"",(a.endPages.length<1||a.endPages.length&&!z)&&(a.startPages.length&&a.startPages[0].text?(h.siteTitle=a.startPages[0].text,h.siteDescription=a.startPages[0].description):(h.siteTitle="",h.siteDescription=""))})}).catch(function(){a.show404=!0}),r.addEventListener("message",x,!1),a.makeTimes=function(e){for(var t=[],n=0;e>n;n++)t.push(n);return t},a.scaleEmbedCfg={minFontSize:.7,maxWidth:680,maxHeight:880},angular.element(r).bind("resize",function(){v(),y(a.scaleEmbedCfg,r.innerWidth,r.innerHeight)}),b(),y(a.scaleEmbedCfg,r.innerWidth,r.innerHeight),a.getBgImgUrl=function(t,a,i,s){return n.getImgUrl(e.backend.domain.replace(":subdomain","")+"/uploads/"+t,a,i,s)},a.getImgUrl=function(e,t,a,i){return n.getImgUrl(e,t,a,i)},a.getMainImgUrl=function(t,i,s){var r=a.questions[a.currentQuestion.index()].imageData,o=parseInt(e.backend.mainImageContainerBaseWidth,10)||540;return r?n.getMainImgUrl(t,i*(r.width/100||1),i,Math.round(r.containerHeight*(i/o)),Math.round(i/o*Math.round(o*r.left*-1/100)||0),Math.round(i/o*Math.round(r.containerHeight*r.top*-1/100)||0),s):n.getImgUrl(t,i,s)},a.mainMediaImg=function(){var t,n=a.questions[a.currentQuestion.index()].imageData,i=parseInt(e.backend.mainImageContainerBaseWidth,10)||540;return a.questions[a.currentQuestion.index()].imageData?(t=n.width<100?n.left+n.width>100?100-n.left:n.width+Math.min(n.left,0):100,{width:t,paddingBottom:Math.round(n.containerHeight/i*100),src:a.questions[a.currentQuestion.index()].imageFile}):null},a.sentAnswer=function(){a.questionAnswer=t.question.sentAnswer()||{},a.questionAnswer.status=a.questionAnswer.status||{},_.forEach(a.currentQuestion.answers(),function(e){a.questionAnswer.status[e._id]={},e._id===a.questionAnswer.selected&&(a.questionAnswer.status[e._id].selected=!0),a.questionAnswer.correct&&(e._id===a.questionAnswer.correct?a.questionAnswer.status[e._id].correct=!0:e._id===a.questionAnswer.selected&&(a.questionAnswer.status[e._id].wrong=!0))})},a.sendAnswer=function(e,n,i){return n&&(n.stopPropagation(),n.preventDefault()),l?!1:t.question.sendAnswer(e).then(function(e){e&&e.hasOwnProperty("error")?a.requiredMessage=e.error:(a.questionAnswer&&!a.questionAnswer.form&&a.sentAnswer(),a.hasNext()&&!M&&a.pagination.curr()<a.pagination.last&&!a.currentQuestion.settings("showAnswers")&&(M=s(function(){"undefinded"==typeof i?a.next():a.next(null,!0),M=null},a.currentQuestion.settings("showCorrectAnswer")?500:200)))})},a.checkUser=function(){return t.user.check()},a.getUser=function(){return t.user.get()},a.pickCorrectEndPage=function(e){var n;switch(a.wayAnimateClass="",a.quiz.type){case"score":e.hasOwnProperty("totalScore")&&a.endPages.length&&(n=_.filter(a.endPages,function(t){return t.coverPage&&t.coverPage.scoreRange&&t.coverPage.scoreRange.min<=e.totalScore/e.maxScore*100&&t.coverPage.scoreRange.max>=e.totalScore/e.maxScore*100?t:void 0}),n.length&&(a.questions.push(n[0]),a.showScore(Math.ceil(e.totalScore/e.maxScore*100))));break;case"outcome":e.hasOwnProperty("outcome")&&a.endPages.length&&(a.scoredOutcome=e.outcome,n=_.filter(a.endPages,function(t){return t.coverPage&&t.coverPage.outcome&&t.coverPage.outcome===e.outcome?t:void 0
}),n.length&&a.questions.push(n[0]));break;default:a.endPages.length&&a.questions.push(a.endPages[0])}t.questions.sync(a.questions,a.currentQuestion.index()),a.wayAnimateClass="way-animation__next"},a.checkUser(),a.submitQuiz=function(e){var n=t.preview.getUserResults();return l?(a.pickCorrectEndPage({}),a.next(null,!0),void 0):d&&n?(a.pickCorrectEndPage(n),_.where(a.questions,{type:"endPage"}).length?a.next(null,!0):a.requiredMessage="Thank you!",void 0):(a.requiredMessage="",(!a.requiredMessage||a.requiredMessage&&a.requiredMessage.length<1)&&(a.requiredMessage="","forms"===a.questions[a.currentQuestion.index()].type?(a.questionAnswer.selected=!0,I(a.questionAnswer.status,e).then(function(){A(P)})):A(P)),void 0)},a.showScore=function(e){a.scoredPoints=e},a.formatAnswers=function(e){return e?100*e:0},a.formatAnswersTransform=function(e){var t=e?100*e:0;return"translate(-50%,"+(100-t)+"%)"},a.prev=function(){t.navigation.prev(),a.sentAnswer(),a.wayAnimateClass="way-animation__prev"},a.hasPrev=function(){return t.navigation.hasPrev()},a.showSubmitButton=function(){return(a.quiz&&"poll"!==a.quiz.type||a.hasForms)&&a.pagination.curr()==a.pagination.last&&!l},a.next=function(e,n){"startPage"===a.questions[a.currentQuestion.index()].type&&m&&f(),"startPage"===a.questions[a.currentQuestion.index()].type||"undefined"!=typeof n?(t.navigation.next(),a.wayAnimateClass="way-animation__next",a.requiredMessage="",a.sentAnswer()):d||l?(t.navigation.next(),a.sentAnswer(),a.wayAnimateClass="way-animation__next"):!a.questionAnswer.form&&(a.currentQuestion.requiredAnswer()&&a.questionAnswer.selected||!a.currentQuestion.requiredAnswer())?(t.navigation.next(),a.sentAnswer(),a.wayAnimateClass="way-animation__next",a.requiredMessage=""):a.questionAnswer&&a.questionAnswer.form&&(a.questionAnswer.form.$valid||1===Object.keys(a.questionAnswer.form.$error).length&&a.questionAnswer.form.$error.fullEmail)?(a.questionAnswer.selected=!0,I(a.questionAnswer.status,e)):a.requiredMessage="Answer is required to proceed to next question",g.send("page-changed",angular.extend({page:a.currentQuestion.index()}))},a.hasNext=function(){return t.navigation.hasNext()},a.currentQuestion={index:t.question.index,settings:t.question.settings,mainMedia:t.question.mainMedia,answers:t.question.answers,inputs:t.question.inputs,answerMedia:t.question.answerMedia,requiredAnswer:t.question.requiredAnswer},a.progressBarWidth=function(){return a.pagination.curr()/a.pagination.last*100},a.socialShare=function(){var t=a.questions[a.currentQuestion.index()],n={};return n={enabled:t.coverPage.showSocialShares?!0:!1,title:a.quiz.settings.share.title||a.quiz.title,description:a.quiz.settings.share.description||"Fill out this"+a.quiz.type+"!",imageUrl:a.quiz.settings.share.imageUrl?a.currentQuestion.answerMedia(a.quiz.settings.share.imageUrl):e.backend.domain+e.backend.share.defaultImgUrl,link:a.quiz.settings.share.link||r.location.href,href:r.location.href,init:function(){"object"==typeof window.twttr&&window.twttr.events.bind("tweet",function(){u.get(e.backend.answers.domain+e.backend.share.other.replace(":service","twitter").replace(":quizId",t.quizId)).then(function(){}).catch(function(){})})}},n.facebook={share:function(){window.open(e.backend.answers.domain+e.backend.share.facebook+"?quizId="+t.quizId+"&description="+n.description+"&name="+n.title+"&image="+n.imageUrl,"_blank","toolbar=no,scrollbars=no,resizable=yes,width=460,height=280")}},("outcome"===a.quiz.type||"score"===a.quiz.type)&&(n.description="I got :result on :quizname on Engageform! What about you?".replace(":quizname",a.quiz.title),n.description=n.description.replace(":result","score"===a.quiz.type?(a.scoredPoints||0)+" percent":a.scoredOutcome||""),"endPage"===t.type&&t.imageFile&&t.settings.showMainMedia&&(n.imageUrl=a.currentQuestion.mainMedia().src)),n}}]),angular.module("4screens.engageform").directive("branding",["EngageformBackendService","$rootScope","CONFIG",function(e,t,n){var a=function(e){var a,i,s,r=n.backend.branding;a=function(e){return e&&e!==r.imageUrl?n.backend.domain+n.backend.imagesUrl+"/"+e:""===e?"":n.backend.domain+r.imageUrl},i=function(e){return _.isUndefined(e)?r.link:e},s=function(e){return _.isUndefined(e)?r.text:e},t.$on("quizReady",function(t,n){e.branding=n.settings.branding,e.branding||(e.branding={}),e.defaultBranding=_.isUndefined(e.branding.link)&&_.isUndefined(e.branding.imageUrl),e.branding.state?(e.branding.text="",e.branding.link="",e.branding.imageUrl=""):(e.branding.text=s(e.branding.text),e.branding.imageUrl=a(e.branding.imageUrl),e.branding.link=i(e.branding.link))})};return{restrict:"E",templateUrl:"views/engageform/branding-logo.html",link:a}}]),angular.module("4screens.engageform").directive("engageformSwiperDirective",["$timeout",function(e){return{restrict:"C",link:function(t){var n,a={slideElement:"article",slidesPerView:1,pagination:".pagination-swiper",calculateHeight:!0,roundLengths:!0,resizeReInit:!0};e(function(){e(function(){e(function(){e(function(){n=new Swiper(".engageform-swiper-directive",a),t.swipeNext=n.swipeNext,t.swipePrev=n.swipePrev})})})})}}}]),angular.module("4screens.engageform").directive("observeHeight",["$window","$timeout",function(e,t){return{link:function(n,a){function i(){return a[0].clientHeight}function s(t){n.$emit("height-changed",{height:t,isHigherThanViewport:t>e.innerHeight})}function r(){var e=i();o=t(function(){var t=i();e!==t&&(s(t),r())},50)}var o;n.$on("$destroy",function(){t.cancel(o)}),n.$applyAsync(function(){s(i()),r()})}}}]),angular.module("4screens.engageform").filter("nl2br",["$sce",function(e){return function(t){return e.trustAsHtml((t+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br />$2"))}}]),angular.module("4screens.engageform").filter("questionsFilter",function(){return function(e){var t=e;return angular.forEach(t,function(e,n){"startPage"===e.type&&0!==n&&t.unshift(t.splice(n,1)[0])}),t}}),angular.module("4screens.engageform").factory("EngageformBackendService",["CONFIG","CommonLocalStorageService","SettingsEngageformService","$q","$filter","$rootScope",function(e,t,n,a,i){function s(){return g.mainMedia=g.mainMedia||{},void 0!==g.mainMedia[d[l]._id]?g.mainMedia[d[l]._id]:(d[l].settings=d[l].settings||{},d[l].settings.showMainMedia?d[l].imageFile?(g.mainMedia[d[l]._id]={$key:d[l]._id,src:"http"!==d[l].imageFile.slice(0,4)?e.backend.domain.replace(":subdomain","")+e.backend.imagesUrl+"/"+d[l].imageFile:d[l].imageFile},g.mainMedia[d[l]._id]):(g.mainMedia[d[l]._id]=null,g.mainMedia[d[l]._id]):(g.mainMedia[d[l]._id]=null,g.mainMedia[d[l]._id]))}function r(e){var t;return t=_.findIndex(p,function(t){return t.stats.questionId===e}),0>t?void 0:p[t]}function o(e){var t=m.questions&&m.questions[e]?m.questions[e]:m[e],n=d[l],a=null;if(!t)return a;switch(n.type){case"multiChoice":t.selectedAnswerId&&(a={selected:t.selectedAnswerId});break;case"pictureChoice":t.selectedAnswerId&&(a={selected:t.selectedAnswerId});break;case"rateIt":t.rateItValue&&(a={selected:t.rateItValue});break;case"forms":if(t.inputs.length){a={status:{}};for(var i in t.inputs)a.status[t.inputs[i]._id]=t.inputs[i].value}}return a}var u,c,d=[],l=0,g={},m=null,p=null,f="ui",h="uig",q="qsa_",w=(new Date).getTime();return g[f]=t.get(f),g[h]=t.get(h),{preview:{setUserResults:function(e){var t=a.defer();return m=e?e:null,t.resolve(),t.promise},setAnswersResults:function(e){var t=a.defer();return p=e&&e.results?e.results:null,t.resolve(e.statsEndPage),t.promise},getUserResults:function(){return m}},quiz:{get:function(e){return n.get(e).then(function(e){return u=e,e})},getStaticThemeCssFile:function(){return u.theme=u.theme||{},u.theme.customThemeCssFile?e.backend.domain.replace(":subdomain","")+"/uploads/"+u.theme.customThemeCssFile+"?"+w:null},submit:function(e){return n.submitQuiz(e,g[f],g[h]).then(function(e){return t.clearAll(),t.set(h,g[h]),g={},g[h]=t.get(h),m&&(e.outcome=m.outcome,e.totalScore=m.totalScore,e.maxScore=m.maxScore),e})}},question:{index:function(){return l},settings:function(e){return d[l].settings=d[l].settings||{},!!d[l].settings[e]},mainMedia:function(){return s()},inputs:function(){return d[l].forms=d[l].forms||{},d[l].forms.inputs},answers:function(){return d[l]?d[l].answers:[]},requiredAnswer:function(){return d[l].requiredAnswer},answerMedia:function(t){return"http"!==t.slice(0,4)?e.backend.domain.replace(":subdomain","")+e.backend.imagesUrl+"/"+t:t},sentAnswer:function(){var e,n;if(!d[l])return null;if(n=d[l]._id,m)e=o(n);else if(p)e=r(n);else{var a=q+n;e=t.get(a)}return e?e:null},sendAnswer:function(e){var i,s={};return s.quizQuestionId=d[l]._id,!u.settings.allowAnswerChange&&t.get(q+s.quizQuestionId)?(i=a.defer(),i.resolve(),i.promise):("rateIt"===d[l].type&&(s.rateItValue=parseInt(e)),["pictureChoice","multiChoice"].indexOf(d[l].type)>-1&&(s.selectedAnswerId=e),"forms"===d[l].type&&(s.inputs=e),g[f]&&(s.userIdent=g[f]),n.sendAnswer(s).then(function(e){if(g[f]=e.userIdent,t.set(f,g[f]),"rateIt"===d[l].type)t.set(q+s.quizQuestionId,{selected:e.selectedValue,average:e.avgRateItValue});else if(["pictureChoice","multiChoice"].indexOf(d[l].type)>-1)t.set(q+s.quizQuestionId,{selected:e.selectedAnswerId,correct:e.correctAnswerId,stats:e.stats});else if("forms"===d[l].type){var n={};_.forEach(s.inputs,function(e){n[e._id]=e.value}),t.set(q+s.quizQuestionId,{status:n})}return e}).catch(function(e){return{error:e.data.msg||e.data.message||"Unexpected error"}}))}},questions:{get:function(){return n.getQuestions(u._id).then(function(e){return d=i("questionsFilter")(_.sortBy(e,"position")),c=d.length-(_.where(d,{type:"startPage"}).length||0)-(_.where(d,{type:"endPage"}).length||0),e})},sync:function(e,t){d=e,l=t}},navigation:{prev:function(){this.hasPrev()&&l--},hasPrev:function(){return l>0},next:function(){this.hasNext()&&l++},hasNext:function(){return l<d.length-1}},user:{check:function(){g[h]||n.getGlobalUserIndent().then(function(e){return g[h]=e,t.set(h,g[h]),g[h]})},get:function(){return{uid:g[f],guid:g[h]}}}}}]),angular.module("4screens.engageform").factory("CloudinaryService",["CONFIG",function(e){function t(e,t){return i+(-1!==t.indexOf(s)?"upload/":"fetch/")+e+"/"+t.replace(s,a)}var n=e.backend.cloudinary.account||"test4screens",a=e.backend.cloudinary.uploadFolderName||"console",i="https://res.cloudinary.com/"+n+"/image/",s=e.backend.domain.replace(":subdomain","")+e.backend.imagesUrl;return{getImgUrl:function(e,n,a,i){var i="undefined"!=typeof i&&"0"!==i?",e_blur:"+100*parseInt(i,10):"",a=",dpr_"+a;return t("w_"+parseInt(n,10)+",f_auto,q_82"+a+",c_limit"+i,e)},getMainImgUrl:function(e,n,a,i,s,r,o){return o="undefined"==typeof o?"":",dpr_"+o,t("w_"+parseInt(n,10)+",f_auto,q_82"+o+"/w_"+a+",h_"+i+",x_"+s+",y_"+r+",c_crop",e)}}}]),angular.module("4screens.engageform").factory("message",["$window",function(e){function t(e,t){if("function"!=typeof t)throw new Error("Provide a function as a callback");i[e]||(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}function n(e,t){return i[e]?(t?i[e].splice(i[e].indexOf(t),1):i[e].lenght=0,!0):!1}function a(e,t){if(i[e])for(var n=0;n<i[e].length;n+=1)i[e][n](t.data||{},t)}var i={};return e.addEventListener("message",function(e){e.data&&e.data.name&&a(e.data.name,e)}),{send:function(t,n){e.parent.postMessage(angular.extend({name:t},n),"*")},on:t,off:n}}]),angular.module("4screens.engageform").factory("openInFullscreen",["$document","message",function(e,t){var n=e[0].body;return function(){n.requestFullscreen?(n.requestFullscreen(),t.send("opened-in-fullscreen")):n.msRequestFullscreen?(n.msRequestFullscreen(),t.send("opened-in-fullscreen")):n.mozRequestFullScreen?(n.mozRequestFullScreen(),t.send("opened-in-fullscreen")):n.webkitRequestFullscreen?(n.webkitRequestFullscreen(),t.send("opened-in-fullscreen")):t.send("request-fullscreen")}}]);